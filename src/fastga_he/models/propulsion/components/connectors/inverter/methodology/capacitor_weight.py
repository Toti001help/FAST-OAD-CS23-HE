# This file is part of FAST-OAD_CS23-HE : A framework for rapid Overall Aircraft Design of Hybrid
# Electric Aircraft.
# Copyright (C) 2022 ISAE-SUPAERO

import numpy as np
from matplotlib import pyplot as plt

if __name__ == "__main__":
    capacitance = np.array(
        [
            290,
            390,
            500,
            680,
            810,
            1000,
            1200,
            1350,
            1600,
            1900,
            2400,
            3000,
            290,
            300,
            390,
            450,
            460,
            850,
            1000,
            1600,
            480,
            1000,
            1500,
            1800,
            900,
            1300,
            1600,
            170,
            240,
            300,
            330,
            400,
            420,
            500,
            600,
            720,
            800,
            1000,
            1100,
            1600,
            1700,
            2000,
            2200,
            420,
            540,
            950,
            1000,
            1200,
            250,
            330,
            420,
            470,
            1100,
            250,
        ]
    )
    rms_current = np.array(
        [
            54,
            66,
            49,
            59,
            58,
            73,
            70,
            86,
            80,
            112,
            111,
            109,
            50,
            60,
            62,
            65,
            70,
            60,
            65,
            75,
            65,
            68,
            60,
            100,
            72,
            100,
            100,
            50,
            55,
            58,
            60,
            60,
            58,
            72,
            65,
            69,
            80,
            85,
            90,
            100,
            110,
            120,
            120,
            60,
            60,
            90,
            90,
            70,
            40,
            55,
            50,
            65,
            85,
            51,
        ]
    )
    weight = np.array(
        [
            600,
            700,
            850,
            1100,
            1300,
            1500,
            1800,
            2000,
            2400,
            3200,
            3900,
            4500,
            595.706233,
            762.7845047,
            762.7845047,
            1035.207542,
            1096.956764,
            1489.245938,
            2048.629099,
            2379.053147,
            1035.207542,
            2048.629099,
            2445.137957,
            3105.986054,
            2048.629099,
            3039.901244,
            3039.901244,
            595.706233,
            762.7845047,
            1035.207542,
            1035.207542,
            1035.207542,
            1035.207542,
            1307.63058,
            1634.538224,
            2048.629099,
            2246.883528,
            2709.477196,
            3039.901244,
            4493.767056,
            4269.345872,
            4814.368749,
            6176.925942,
            1307.63058,
            1634.538224,
            3105.986054,
            3105.986054,
            3502.494912,
            1031.575235,
            1307.63058,
            1387.781003,
            2127.930871,
            4361.597437,
            1126.015221,
        ]
    )

    B = np.log(weight)

    A = np.column_stack([np.ones_like(rms_current), np.log(rms_current), np.log(capacitance)])

    x = np.linalg.lstsq(A, B, rcond=-1)
    a, b, c = x[0]

    print(np.exp(a) * rms_current**b * capacitance**c)
    print(weight)

    plt.plot(weight, np.exp(a) * rms_current**b * capacitance**c)
    plt.show()
